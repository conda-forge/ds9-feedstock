{% set name = "ds9" %}
{% set version = "8.7" %}
{% set number = "1" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://github.com/SAOImageDS9/SAOImageDS9/archive/refs/tags/v{{ version }}.tar.gz
  sha256: bd2ff7a25e959bbecc462f8b2da7465f0fcc3c8fc335013b7d323e93e5304049
  patches:
    - configure.patch
    - Makefile.in.patch
    - make.include.patch
    - libtiff_configure.patch
    - pngpriv.h.patch
    - zutil.h.patch

build:
  number: {{ number }}
  skip: true  # [win]
  ignore_run_exports:  # these are only *direct* deps at build time
    - libexpat
    - libxslt

requirements:
  build:
    - {{ compiler("c") }}
    - {{ compiler("cxx") }}
    - {{ stdlib("c") }}
    - make
    - autoconf
    - automake
    - m4
    - pkg-config
    - zip
  host:
    - expat
    - fontconfig
    - freetype
    - libiconv
    # ds9 apparently links directly against lzma and icu
    # so we cannot remove these even with libxml2-devel
    - icu
    - liblzma-devel
    - libxml2-devel
    - libxslt
    - xorg-libx11
    - xorg-libxft
    - xorg-xorgproto
    - zlib
  run:
    - xorg-libxcursor   # [linux]
    - xorg-libxfixes    # [linux]

test:
  commands:
    - ds9 -help  # doesn't require a display, which might not exist

about:
  home: https://github.com/SAOImageDS9/SAOImageDS9
  summary: SAOImage DS9 is an astronomical imaging and data visualization application
  license: GPL-3.0-only
  license_family: GPL
  license_file: LICENSE

extra:
  recipe-maintainers:
    - jehturner
    - epassaro
